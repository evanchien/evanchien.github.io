<!DOCTYPE html>
<html class="">
<head>
  <meta charset="UTF-8">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Personal portfolio, Evan Chien, Display technologies, Robotics">
  <meta rel="author" href="">
  <meta rel="publisher" href="">

  <title>
    
      Loss Functions in YOLOv3 | Evan's Personal page
    
  </title>

  <link rel="stylesheet" href="/assets/css/all.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Evan's Personal page" />

  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  


  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Loss Functions in YOLOv3 | Evan’s Personal page</title>
<meta name="generator" content="Jekyll v3.6.2" />
<meta property="og:title" content="Loss Functions in YOLOv3" />
<meta name="author" content="Paul Le" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Bounding Boxes" />
<meta property="og:description" content="Bounding Boxes" />
<link rel="canonical" href="http://localhost:4000/Loss-Functions.html" />
<meta property="og:url" content="http://localhost:4000/Loss-Functions.html" />
<meta property="og:site_name" content="Evan’s Personal page" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-16T00:00:00-06:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/Loss-Functions.html","dateModified":"2021-02-16T00:00:00-06:00","datePublished":"2021-02-16T00:00:00-06:00","headline":"Loss Functions in YOLOv3","author":{"@type":"Person","name":"Paul Le"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Loss-Functions.html"},"description":"Bounding Boxes","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>
<body>

<div class="site-container">

  <header>
  <div class="logo">
    <a href="/">Evan's Personal page</a>
  </div>
  <nav>
    
      <a href="/">Projects</a>
    
      <a href="/pages/blog.html">Blog</a>
    
      <a href="/pages/about.html">About</a>
    
      <a href="/pages/contact.html">Contact</a>
    
  </nav>
</header>


  <section>
  <div class="work-container">
    <h4 class="project-title">Loss Functions in YOLOv3</h4>
    <div class="project-load"><h3 id="bounding-boxes">Bounding Boxes</h3>

<p>For bounding boxes, the loss is MSE of 1. delta in center coordinates and 2. delta in width and height.<br />
$b_x$ = $\sigma$($t_x$) + $c_x$<br />
$b_y$ = $\sigma$($t_y$) = $c_y$<br />
$b_w$ = $p_w<script type="math/tex">e^{t_w}$
$b_h$ = $p_h</script>e^{t_h}$</p>

<h3 id="classification">Classification</h3>

<p>In YOLOv3, the loss for classification is Binary Cross-Entropy loss rather than the general Softmax CE. Softmax links the confidence of each class together while Binary CE keeps them independent. We can treat a binary CE as a 2-class CE.</p>

<p>CE = - t $\log( f ( s ) )$ - ( 1 - t ) $\log( 1 - f ( s ) )$ , where s and 1 - f ( s ) are the score for positive and negative, t and (1-t) are the ground truth.</p>

<p>Applying this to each class, the combined loss for class $C_i$ is as:</p>

<p>CE = $\begin{matrix} - \log(f(s_i))\-\log(1-f(s_i))&amp;  \end{matrix}     \begin{matrix} if\ t_i = 1\ (object)\if \ t_i = 0\ (background)\end{matrix}$ , where f ( $s_i$ ) = $\frac{1}{1 + e^{-s_i}}$</p>

<p>The gradient respect to the score $s_i$ = $S_1$ can be written as:</p>

<p>$\frac{\partial }{\partial S_i}$(CE ( f ( $s_i$ ) ) ) = $t_1$ ( f ( $s_1$ ) -1) + (1 - $t_1$) f ( $s_1$ )  ,where f( $s_i$ ) is the sigmoid fn,  ( f = $\frac{1}{1+e^{-x}})$ , $\frac {df}{dx} $ = $\frac{e^{-x}}{(1+e^{-x})^2}$ = f ( 1- f )
or<br />
$\frac{\partial }{\partial S_i}$(CE ( f ( $s_i$ ) ) ) = $\begin{matrix} f ( s_i)-1 \f ( s_i)&amp;  \end{matrix}$ $\begin{matrix} if&amp;t_i = 1\if &amp;t_i = 0\end{matrix}$</p>

</div>
  </div>
  
</section>
<footer>
  <div class="footer-wrap">
    <div class="footer-tagline">
      <p></p>
    </div>
    <div class="social-media">
      <nav>
        
          <a href="http://instagram.com/roxetti" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a>
        
          <a href="http://github.com/evanchien" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
        
          <a href="http://linkedin.com/in/evanchien" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
        
          <a href="mailto:#evan.ch.chien@gmail.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
        
      </nav>
    </div>
  </div>
</footer>



</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="/assets/js/functions.js"></script>
</body>
</html>
